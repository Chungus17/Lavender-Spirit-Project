<!-- templates/admin.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Admin - Add Project</title>

    <!-- In <head> -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Before </body> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <h1>Add New Project</h1>
{% if message %}<p style="color: green;">{{ message }}</p>{% endif %}

<form method="POST" enctype="multipart/form-data">
  <input type="hidden" name="form_type" value="create">
  <input type="text" name="title" placeholder="Title" required><br><br>
  <textarea name="description" placeholder="Description" required></textarea><br><br>
  <input type="text" name="project_type" placeholder="Project Type" required><br><br>
  <select name="status" required>
    <option value="Planning">Planning</option>
    <option value="In Progress">In Progress</option>
    <option value="Completed">Completed</option>
  </select><br><br>
  <input type="file" name="image_file" required><br><br>
  <button type="submit">Add Project</button>
</form>

<hr>
<h2>All Projects</h2>
<ul>
  {% for project in projects %}
    <li>
      <strong>{{ project.title }}</strong> - {{ project.status }}<br>
      <img src="{{ url_for('static', filename='uploads/' + project.image_filename) }}" width="100"><br>
      <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#editModal{{ project.id }}">Edit</button>
    </li>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal{{ project.id }}" tabindex="-1" aria-labelledby="editModalLabel{{ project.id }}" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form method="POST" enctype="multipart/form-data">
            <input type="hidden" name="form_type" value="edit">
            <input type="hidden" name="project_id" value="{{ project.id }}">
            <div class="modal-header">
              <h5 class="modal-title" id="editModalLabel{{ project.id }}">Edit Project</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <label>Title:</label>
              <input type="text" name="title" value="{{ project.title }}" class="form-control" required>

              <label>Description:</label>
              <textarea name="description" class="form-control" required>{{ project.description }}</textarea>

              <label>Project Type:</label>
              <input type="text" name="project_type" value="{{ project.project_type }}" class="form-control" required>

              <label>Status:</label>
              <select name="status" class="form-control" required>
                <option value="Planning" {% if project.status == 'Planning' %}selected{% endif %}>Planning</option>
                <option value="In Progress" {% if project.status == 'In Progress' %}selected{% endif %}>In Progress</option>
                <option value="Completed" {% if project.status == 'Completed' %}selected{% endif %}>Completed</option>
              </select>

              <label>Replace Image:</label>
              <input type="file" name="image_file" class="form-control">

              <p>Current Image:</p>
              <img src="{{ url_for('static', filename='uploads/' + project.image_filename) }}" width="100">
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-success">Save Changes</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  {% endfor %}
</ul>
  </body>
</html>
